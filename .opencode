language: ko

project:
  stack:
    - spring-boot-3
    - jdk-21
    - gradle
    - mybatis
    - redis
    - h2
    - vanilla-js
  architecture:
    - layered-architecture
    - rest-api
    - event-driven-rollback
    - mdc-logging

style:
  comments: korean
  explain: detailed
  code: clean-and-readable
  refactor: readability-first

rules:

  logging:
    framework: slf4j
    config: logback-spring.xml
    use_mdc: true
    mdc_keys:
      - traceId
      - userId
      - requestUri
    rule: "모든 서비스/컨트롤러 로직에 MDC 흐름을 유지한다"

  transaction:
    framework: spring
    rule:
      - "@Transactional 경계 기준으로 롤백 시점 이해"
      - "롤백 이후 동작은 TransactionalEventListener AFTER_ROLLBACK 사용"
      - "외부 시스템 호출 실패 시 이벤트 기반 복구 처리"

  mybatis:
    mapper_style: xml
    rule:
      - "SQL은 Mapper XML에 작성"
      - "동적 쿼리 가독성 우선"
      - "파라미터/결과 매핑 명확히"

  controller:
    rule:
      - "RESTful API 설계"
      - "에러 응답 표준화"
      - "JSON 구조 일관성 유지"

  frontend:
    rule:
      - "HTML + CSS + Vanilla JavaScript"
      - "fetch 기반 API 호출"
      - "CRUD 화면 단순/명확"

  code_generation:
    sample_data_from_db_meta: true
    json_serialization: gson
    rule:
      - "DB 메타정보 기반 샘플 JSON 생성"
      - "계층형 JSON → ROW 구조 변환 고려"

commands_preference:
  - explain before edit
  - refactor with comments
  - keep existing structure unless improvement is clear
